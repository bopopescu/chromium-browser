# 2 prefixes of the same type
# lock lock add %eax,(%rsp)
F0 F0 01 04 24
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# rep rep stos %eax,%es:(%rdi)
89 FF
49 8D 3C 3F
F3 F3 AB
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# repne rep stos %eax,%es:(%rdi)
89 FF
49 8D 3C 3F
F2 F3 AB
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# rep repne scas %es:(%rdi),%al
89 FF
49 8D 3C 3F
F3 F2 AE
# fs gs mov %eax,%eax
64 65 89 C0
# 0x66 mov %ax,%ax
66 66 89 C0
# 0x67 mov %eax,(%esp)
67 67 89 04 24
# rex rex jmp $
40 40 EB FD

# 2 prefixes of different type
# lock add %eax, %ss:(%rsp)
36 F0 01 04 24
F0 36 01 04 24
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# es rep stos %eax,%es:(%rdi)
89 FF
49 8D 3C 3F
26 F3 AB
89 FF
49 8D 3C 3F
F3 26 AB
# lock add %ax, (%rsp)
66 F0 01 04 24
F0 66 01 04 24
# Doesn't validate due to bug.
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# rep stosw %ax,%es:(%rdi)
89 FF
49 8D 3C 3F
66 F3 AB
89 FF
49 8D 3C 3F
F3 66 AB
# lock add %eax, (%esp)
67 F0 01 04 24
F0 67 01 04 24
# rep stos %eax, %es:(%edi)
89 FF
49 8D 3C 3F
67 F3 AB
89 FF
49 8D 3C 3F
F3 67 AB
# lock add %rax, (%rsp)
f0 48 01 04 24
48 f0 01 04 24
# mov %edi,%edi
# lea (%r15,%rdi),%rdi
# rep stos %rax,%es:(%rdi)
89 FF
49 8D 3C 3F
F3 48 AB
# fs mov %ax,%ax
64 66 89 C0
66 64 89 C0
# fs add %eax, (%esp)
67 64 01 04 24
64 67 01 04 24
# fs mov %rax,%rax
64 48 89 C0
48 64 89 C0
# add %ax, (%esp)
66 67 01 04 24
67 66 01 04 24
# mov %r15l, (%rsp)
66 44 89 3C 24
44 66 89 3C 24
# mov %r15, (%esp)
67 4C 89 3C 24
4C 67 89 3C 24

# 2 prefixes when one is mandatory
# fs phaddw %xmm0,%xmm1
64 66 0F 38 01 C8
# fs addsd %xmm0,%xmm1
64 F2 0F 58 C8
# 0x66 phaddw %xmm0,%xmm1
66 66 0F 38 01 C8
# 0x66 addsd %xmm0,%xmm1
66 F2 0F 58 C8
# phaddw (%esp), %xmm0
67 66 0f 38 01 04 24
# addsd (%esp), %xmm0
67 f2 0f 58 04 24
# mov %eax,%eax
# phaddw (%r15,%rax),%xmm0
89 C0
66 41 0F 38 01 04 07
89 C0
41 66 0F 38 01 04 07
# mov %eax,%eax
# addsd (%r15,%rax),%xmm0
89 C0
F2 41 0F 58 04 07
89 C0
41 F2 0F 58 04 07